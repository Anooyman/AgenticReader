<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’¬ LLMReader èŠå¤©æ¨¡å¼</title>

    <!-- CSS æ ·å¼ -->
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/chat.css">

    <!-- Markdown æ”¯æŒ -->
    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.0/marked.min.js"></script>

    <!-- MathJax æ•°å­¦å…¬å¼æ”¯æŒ -->
    <script type="text/javascript">
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true,
                packages: {'[+]': ['ams', 'newcommand', 'configmacros']},
                tags: 'ams',
                tagSide: 'right',
                tagIndent: '.8em',
                multlineWidth: '85%',
                autoload: {
                    color: [],
                    colorV2: ['color']
                }
            },
            chtml: {
                scale: 1.0,
                minScale: 0.5,
                matchFontHeight: false,
                fontURL: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2'
            },
            svg: {
                scale: 1.0,
                minScale: 0.5,
                matchFontHeight: false,
                fontCache: 'global'
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process',
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                renderActions: {
                    addMenu: [0, '', '']
                }
            },
            startup: {
                ready: function () {
                    MathJax.startup.defaultReady();
                    console.log('âœ“ MathJax å·²åˆå§‹åŒ–');
                    // é…ç½®å®Œæˆï¼Œç­‰å¾…åº”ç”¨è°ƒç”¨ typesetPromise
                }
            }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>
<body class="chat-mode">
    <!-- èŠå¤©é¡µé¢å®¹å™¨ -->
    <div class="chat-app-container">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <header class="chat-header">
            <div class="chat-nav">
                <div class="nav-left">
                    <a href="/" class="nav-btn back-btn">
                        <span>ğŸ </span>
                        <span>è¿”å›ä¸»é¡µ</span>
                    </a>
                    <h1 class="chat-title">ğŸ’¬ LLMReader èŠå¤©æ¨¡å¼</h1>
                </div>
                <div class="nav-right">
                    <div class="document-info" id="chat-doc-status">
                        <span class="doc-icon">ğŸ“„</span>
                        <span id="chat-current-doc">æœªåŠ è½½æ–‡æ¡£</span>
                    </div>
                    <button class="nav-btn toggle-pdf-btn" id="toggle-pdf-viewer">
                        <span>ğŸ“–</span>
                        <span class="btn-text">PDF</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- ä¸»è¦èŠå¤©åŒºåŸŸ -->
        <main class="chat-main">

            <!-- èŠå¤©å®¹å™¨ -->
            <div class="chat-conversation" id="chat-conversation">
                <!-- èŠå¤©æ¶ˆæ¯åŒºåŸŸ -->
                <div class="chat-messages-full" id="chat-messages-full">
                    <div class="welcome-message-full">
                        <div class="welcome-content">
                            <h3>ğŸ¤– æ™ºèƒ½æ–‡æ¡£é—®ç­”åŠ©æ‰‹</h3>
                            <p>æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„æ™ºèƒ½æ–‡æ¡£åŠ©æ‰‹ã€‚</p>
                            <div class="welcome-status" id="welcome-doc-status">
                                <span class="status-text">è¯·å…ˆåœ¨ä¸»é¡µé¢å¤„ç†æ–‡æ¡£ï¼Œç„¶åå›åˆ°è¿™é‡Œå¼€å§‹å¯¹è¯</span>
                            </div>
                            <div class="quick-suggestions" id="quick-suggestions" style="display: none;">
                                <h4>ğŸ’¡ å»ºè®®é—®é¢˜ï¼š</h4>
                                <div class="suggestion-buttons">
                                    <button class="suggestion-btn" data-question="è¯·æ€»ç»“è¿™ç¯‡æ–‡æ¡£çš„ä¸»è¦å†…å®¹">ğŸ“‹ æ€»ç»“ä¸»è¦å†…å®¹</button>
                                    <button class="suggestion-btn" data-question="è¿™ç¯‡æ–‡æ¡£æœ‰ä»€ä¹ˆåˆ›æ–°ç‚¹ï¼Ÿ">ğŸ’¡ åˆ†æåˆ›æ–°ç‚¹</button>
                                    <button class="suggestion-btn" data-question="æ–‡æ¡£ä¸­æåˆ°çš„æ–¹æ³•æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ">âš–ï¸ åˆ†æä¼˜ç¼ºç‚¹</button>
                                    <button class="suggestion-btn" data-question="èƒ½å¦è¯¦ç»†è§£é‡Šæ–‡æ¡£ä¸­çš„æ ¸å¿ƒæ¦‚å¿µï¼Ÿ">ğŸ” è§£é‡Šæ ¸å¿ƒæ¦‚å¿µ</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- è¾“å…¥åŒºåŸŸ -->
                <div class="chat-input-area">
                    <div class="input-container">
                        <textarea
                            id="chat-input-full"
                            placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜â€¦"
                            rows="2"
                            disabled></textarea>
                        <button id="send-btn-full" class="send-btn-full" disabled>
                            <span class="send-icon">ğŸ“¤</span>
                            <span class="send-text">å‘é€</span>
                        </button>
                    </div>
                    <div class="input-footer">
                        <div class="connection-status-full">
                            <span class="status-indicator-full" id="status-indicator-full">â—</span>
                            <span id="status-text-full">è¿æ¥ä¸­...</span>
                        </div>
                        <div class="input-actions">
                            <button class="action-btn" id="clear-chat-full">ğŸ—‘ï¸ æ¸…ç©ºå¯¹è¯</button>
                            <button class="action-btn" id="export-chat">ğŸ’¾ å¯¼å‡ºå¯¹è¯</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PDFæŸ¥çœ‹å™¨ -->
            <div class="chat-pdf-viewer" id="chat-pdf-viewer">
                <div class="pdf-viewer-header-full">
                    <h4>ğŸ“„ æ–‡æ¡£é¢„è§ˆ</h4>
                    <div class="pdf-controls-full">
                        <button id="pdf-prev-page-full" class="pdf-control-btn-full" disabled>â—€</button>
                        <span id="pdf-page-info-full">æ— æ–‡æ¡£</span>
                        <button id="pdf-next-page-full" class="pdf-control-btn-full" disabled>â–¶</button>
                    </div>
                    <button class="close-pdf-btn" id="close-pdf-viewer">âœ•</button>
                </div>
                <div class="pdf-viewer-content-full" id="pdf-viewer-content-full">
                    <div class="no-document-message">
                        <div class="no-doc-content">
                            <span class="no-doc-icon">ğŸ“„</span>
                            <h3>æš‚æ— æ–‡æ¡£</h3>
                            <p>è¯·å…ˆåœ¨ä¸»é¡µé¢ä¸Šä¼ å¹¶å¤„ç†æ–‡æ¡£</p>
                            <a href="/" class="btn btn-primary">å‰å¾€ä¸»é¡µé¢</a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- JavaScript -->
    <script src="/static/js/chat.js"></script>
    
    <!-- ğŸ”¬ LaTeX æ·±åº¦è¯Šæ–­å·¥å…· (ä»…å¼€å‘ç¯å¢ƒ) -->
    <script src="/static/latex-deep-diagnostics.js"></script>
</body>
</html>